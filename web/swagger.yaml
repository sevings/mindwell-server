consumes:
  - application/json
info:
  title: Mindwell
  version: 0.1.0
securityDefinitions:
  ApiKeyHeader:
    type: apiKey
    in: header
    name: X-User-Key
definitions:
  UserID:
    type: object
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string
        minLength: 1
        maxLength: 20
      negKarma:
        type: boolean
      followersCount:
        type: integer
        format: int64
      isInvited:
        type: boolean
      ban:
        type: object
        properties:
          invite:
            type: boolean
          vote:
            type: boolean
          comment:
            type: boolean
          live:
            type: boolean
  Error:
    type: object
    properties:
      message:
        type: string
    example:
      message: Access denied
  Color:
    type: string
    pattern: '#[0-9a-fA-F]{6}'
    example: '#373737'
    description: color in rgb
  Avatar:
    type: object
    properties:
      x124:
        type: string
      x92:
        type: string
      x42:
        type: string
  Cover:
    type: object
    properties:
      id:
        type: integer
        format: int64
        minimum: 1
        description: user id
      x1920:
        type: string
      x318:
        type: string
  User:
    type: object
    properties:
      id:
        type: integer
        format: int64
        minimum: 1
      name:
        type: string
        minLength: 1
        maxLength: 20
      showName:
        type: string
        minLength: 1
        maxLength: 20
      isOnline:
        type: boolean
      avatar:
        $ref: '#/definitions/Avatar'
    example:
      id: 1
      name: 'binque'
      showName: 'Бинк'
      isOnline: false
  Friend: 
    allOf:
      - $ref: '#/definitions/User'
      - type: object
        properties:
          gender:
            type: string
            enum: [male, female, not set]
          privacy:
            type: string
            enum: [all, followers]
          title:
            type: string
            maxLength: 260
          rank:
            type: number
            format: int64
          lastSeenAt:
            type: number
            format: double
          cover:
            $ref: '#/definitions/Cover'
          counts:
            type: object
            properties:
              entries:
                type: integer
              followings:
                type: integer
              followers:
                type: integer
              ignored:
                type: integer
              invited:
                type: integer
              comments:
                type: integer
              favorites:
                type: integer
              tags:
                type: integer
              days:
                type: integer
  FriendList:
    type: object
    properties:
      subject:
        $ref: '#/definitions/User'
      relation:
        type: string
        enum: [followers, followings, requested, ignored, invited]
      users:
        type: array
        items:
          $ref: '#/definitions/Friend'
  Profile:
    allOf:
      - $ref: '#/definitions/Friend'
      - type: object
        properties:
          isDaylog:
            type: boolean
          createdAt:
            type: number
            format: double
          invitedBy:
            $ref: '#/definitions/User'
          ageLowerBound:
            type: integer
          ageUpperBound:
            type: integer
          country:
            type: string
            maxLength: 50
          city:
            type: string
            maxLength: 50
          design:
            $ref: '#/definitions/Design'
          relations:
            type: object
            properties:
              toMe:
                type: string
                enum: [followed, requested, ignored, none]
              fromMe:
                type: string
                enum: [followed, requested, ignored, none]
        example:
          gender: male
          isDaylog: false
          privacy: all
          title: 'some tlog title'
          rank: 17
          createdAt: 1531029717.333
          lastSeenAt: 1531029717.333
          country: Россия
          city: Казань
          counts:
            entries: 13
            followings: 4
            followers: 15
            ignored: 0
            invited: 0
            comments: 22
            favorites: 1
            tags: 0
          relations:
            toMe: none
            fromMe: followed
  Design:
    type: object
    properties:
      css:
        type: string
      backgroundColor:
        $ref: '#/definitions/Color'
      textColor:
        $ref: '#/definitions/Color'
      fontFamily:
        type: string
      fontSize:
        type: integer
      textAlignment:
        type: string
        enum: [left, right, center, justify]
  AuthProfile:
    allOf:
      - $ref: '#/definitions/Profile'
      - type: object
        properties:
          birthday:
            type: string
            format: full-date
          showInTops:
            type: boolean
          account:
            type: object
            properties:
              apiKey:
                type: string
              validThru:
                type: number
                format: double
              email:
                type: string
              verified:
                type: boolean
          ban:
            type: object
            properties:
              invite:
                type: number
                format: double
              vote:
                type: number
                format: double
              comment:
                type: number
                format: double
              live:
                type: number
                format: double
        example:
          account:
            apiKey: 'blah-blah-blah'
            validThru: '1985-04-12T23:20:50.52Z'
            email: 'mail@example.com'
            verified: true
  Entry:
    type: object
    properties:
      id:
        type: integer
        format: int64
        minimum: 1
      author:
        $ref: '#/definitions/User'
      createdAt:
        type: number
        format: double
      rating:
        $ref: '#/definitions/Rating'
      title:
        type: string
      cutTitle: 
        type: string
      content:
        type: string
      cutContent:
        type: string
      editContent:
        type: string
      hasCut:
        type: boolean
      wordCount:
        type: integer
      privacy:
        type: string
        enum: [all, some, me, anonymous]
      visibleFor:
        type: array
        items:
          $ref: '#/definitions/User'
      inLive:
        type: boolean
      commentCount:
        type: integer
      isFavorited:
        type: boolean
      isWatching:
        type: boolean
      comments:
          $ref: '#/definitions/CommentList'
      rights:
        type: object
        properties:
          edit:
            type: boolean
          delete:
            type: boolean
          comment:
            type: boolean
          vote:
            type: boolean
    example:
      id: 152
      createdAt: 1531029717.333
      rating: -3
      title: 'example title'
      content: '<p>some text with <b>html</b> tags</p>'
      editContent: 'some text with *html* tags'
      wordCount: 5
      privacy: 'all'
      isVotable: true
      commentCount: 0
  Feed:
    type: object
    properties:
      entries:
        type: array
        items:
          $ref: '#/definitions/Entry'
      nextAfter:
        type: string
      hasAfter:
        type: boolean
      nextBefore:
        type: string
      hasBefore:
        type: boolean
  Rating:
    type: object
    properties:
      id:
        type: integer
        format: int64
        minimum: 1
      isVotable:
        type: boolean
      upCount:
        type: integer
      downCount:
        type: integer
      rating:
        type: number
        format: float
      vote:
        type: integer
  FavoriteStatus:
    type: object
    properties:
      id:
        type: integer
        format: int64
        minimum: 1
      isFavorited:
        type: boolean
  WatchingStatus:
    type: object
    properties:
      id:
        type: integer
        format: int64
        minimum: 1
      isWatching:
        type: boolean
  Relationship:
    type: object
    properties:
      from:
        type: string
      to:
        type: string
      relation:
        type: string
        enum: [followed, requested, ignored, none]
  Comment:
    type: object
    properties:
      id:
        type: integer
        format: int64
        minimum: 1
      author:
        $ref: '#/definitions/User'
      entryId:
        type: integer
        format: int64
        minimum: 1
      createdAt:
        type: number
        format: double
      content:
        type: string
      editContent:
        type: string
      rating:
        $ref: '#/definitions/Rating'
      rights:
        type: object
        properties:
          edit:
            type: boolean
          delete:
            type: boolean
          vote:
            type: boolean
    example:
      id: 999
      entryId: 152
      createdAt: 1531029717.333
      content: 'some multiline text \n without html'
  CommentList:
    type: object
    properties:
      data:
        type: array
        items:
          $ref: '#/definitions/Comment'
      nextAfter:
        type: string
      hasAfter:
        type: boolean
      nextBefore:
        type: string
      hasBefore:
        type: boolean
  Notification:
    type: object
    properties:
      id:
        type: integer
        format: int64
        minimum: 1
      type: 
        type: string
        enum: [comment, follower, request, accept, invite, welcome]
      read:
        type: boolean
      createdAt:
        type: number
        format: double
      user:
        $ref: '#/definitions/User'
      comment:
        $ref: '#/definitions/Comment'
      entry: 
        $ref: '#/definitions/Entry'
  NotificationList:
    type: object
    properties:
      notifications:
        type: array
        items:
          $ref: '#/definitions/Notification'
      unreadCount:
        type: integer
      nextAfter:
        type: string
      hasAfter:
        type: boolean
      nextBefore:
        type: string
      hasBefore:
        type: boolean
  ImageSize:
    type: object
    properties:
      width: 
        type: integer
      height:
        type: integer
      url:
        type: string
  Image:
    type: object
    properties:
      id:
        type: integer
        format: int64
      userId:
        type: integer
        format: int64
      mimeType:
        type: string
      small: 
        $ref: '#/definitions/ImageSize'
      medium:
        $ref: '#/definitions/ImageSize'
      large:
        $ref: '#/definitions/ImageSize'
  ImageList:
    type: object
    properties:
      data:
        type: array
        items:
          $ref: '#/definitions/Image'
      nextAfter:
        type: string
      hasAfter:
        type: boolean
      nextBefore:
        type: string
      hasBefore:
        type: boolean
parameters:
  pathId:
    in: path
    name: id
    type: integer
    format: int64
    minimum: 1
    required: true
  pathName:
    in: path
    name: 'name'
    type: string
    minLength: 1
    maxLength: 20
    required: true
  limit:
    in: query
    name: limit
    type: integer
    minimum: 1
    maximum: 100
    default: 30
  skip:
    in: query
    name: skip
    type: integer
    default: 0
  after:
    in: query
    name: after
    type: string
    default: ""
  before:
    in: query
    name: before
    type: string
    default: ""
  tag:
    in: query
    name: tag
    type: string
    maxLength: 50
  sort:
    in: query
    name: sort
    type: string
    enum: [new, old, best]
    default: new
paths:
  /account/email/{email}:
    get:
      summary: check if email is used
      parameters:
        - in: path
          name: email
          type: string
          required: true
          maxLength: 500
      tags:
        - account
      responses:
        200:
          description: check result
          schema:
            type: object
            properties:
              email:
                type: string
              isFree:
                type: boolean
            required:
              - email
              - isFree
            example:
              email: mail@example.com
              isFree: true
  /account/name/{name}:
    get:
      summary: check if name is used
      parameters:
        - in: path
          name: name
          type: string
          minLength: 1
          maxLength: 20
          required: true
      tags:
        - account
      responses:
        200:
          description: check result
          schema:
            type: object
            properties:
              name:
                type: string
              isFree:
                type: boolean
            required:
              - name
              - isFree
            example:
              name: example
              isFree: false
  /account/register:
    post:
      summary: register new account
      consumes:
        - multipart/form-data
        - application/x-www-form-urlencoded
      parameters:
        - in: formData
          name: name
          type: string
          minLength: 1
          maxLength: 20
          required: true
          pattern: "[a-zA-Z][a-zA-Z0-9]*"
        - in: formData
          name: email
          type: string
          maxLength: 500
          required: true
        - in: formData
          name: password
          type: string
          minLength: 6
          maxLength: 100
          required: true
        - in: formData
          name: invite
          type: string
          required: true
          maxLength: 100
        - in: formData
          name: birthday
          type: string
          format: full-date
        - in: formData
          name: gender
          type: string
          enum: [not set, male, female]
          default: not set
        - in: formData
          name: country
          type: string
          default: ''
          maxLength: 50
        - in: formData
          name: city
          type: string
          default: ''
          maxLength: 50
      tags:
        - account
      responses:
        201:
          description: OK
          schema:
            $ref: '#/definitions/AuthProfile'
        400:
          description: email or name already exists
          schema:
            $ref: '#/definitions/Error'
  /account/login:
    post:
      consumes:
        - multipart/form-data
        - application/x-www-form-urlencoded
      parameters:
        - in: formData
          name: name
          type: string
          minLength: 1
          maxLength: 500
          required: true
        - in: formData
          name: password
          type: string
          minLength: 6
          maxLength: 500
          required: true
      tags:
        - account
      responses:
        200:
          description: OK
          schema:
            $ref: '#/definitions/AuthProfile'
        400:
          description: User not found
          schema:
            $ref: '#/definitions/Error'
  /account/verification:
    post:
      summary: request verification email
      security:
        - ApiKeyHeader: []
      tags:
        - account
      responses:
        200:
          description: email has been sent
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
  /account/verification/{email}:
    get:
      summary: verify account email
      parameters:
        - in: path
          type: string
          name: email
          maxLength: 500
          required: true
        - in: query
          type: string
          name: code
          minLength: 64
          maxLength: 64
          required: true
      tags:
        - account
      responses:
        200:
          description: verified
        400:
          description: code or email is not valid
          schema:
            $ref: '#/definitions/Error'
  /account/settings/email:
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - account
      responses:
        200:
          description: email notification settings
          schema:
            type: object
            properties:
              comments:
                type: boolean
              followers:
                type: boolean
              invites:
                type: boolean
    put:
      security:
        - ApiKeyHeader: []
      tags:
        - account
      consumes:
        - multipart/form-data
      parameters:
        - in: formData
          type: boolean
          name: comments
          default: false
        - in: formData
          type: boolean
          name: followers
          default: false
        - in: formData
          type: boolean
          name: invites
          default: false
      responses:
        200:
          description: email notification settings has been updated
  /account/password:
    post:
      summary: change new password
      consumes:
        - multipart/form-data
      parameters:
        - in: formData
          type: string
          name: old_password
          minLength: 6
          maxLength: 100
          required: true
        - in: formData
          type: string
          name: new_password
          minLength: 6
          maxLength: 100
          required: true
      security:
        - ApiKeyHeader: []
      tags:
        - account
      responses:
        200:
          description: password has been set
        403:
          description: old password is invalid
          schema:
            $ref: '#/definitions/Error'
  /account/email:
    post:
      summary: set new email
      consumes:
        - multipart/form-data
      parameters:
        - in: formData
          type: string
          name: email
          minLength: 6
          maxLength: 500
          required: true
        - in: formData
          type: string
          name: password
          minLength: 6
          maxLength: 100
          required: true
      security:
        - ApiKeyHeader: []
      tags:
        - account
      responses:
        200:
          description: email has been set
        400:
          description: email is the same
          schema:
            $ref: '#/definitions/Error'         
        403:
          description: password is invalid
          schema:
            $ref: '#/definitions/Error'
  /account/recover:
    post:
      summary: request reset password email
      consumes:
        - multipart/form-data
      parameters:
        - in: formData
          name: email
          type: string
          maxLength: 500
          required: true
      tags:
        - account
      responses:
        200:
          description: OK
        400:
          description: Email not found
          schema:
            $ref: '#/definitions/Error'
  /account/recover/password:
    post:
      summary: reset password
      consumes:
        - multipart/form-data
      parameters:
        - in: formData
          name: email
          type: string
          maxLength: 500
          required: true
        - in: formData
          type: string
          name: password
          minLength: 6
          maxLength: 100
          required: true
        - in: formData
          type: integer
          format: int64
          name: date
          required: true
        - in: formData
          type: string
          name: code
          minLength: 64
          maxLength: 64
          required: true
      tags:
        - account
      responses:
        200:
          description: Password changed
        400:
          description: Email not found
          schema:
            $ref: '#/definitions/Error'
  /account/invites:
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - account
      responses:
        200:
          description: invite list
          schema:
            type: object
            properties:
              invites:
                type: array
                items:
                  type: string
  /account/subscribe/token:
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - account
      responses:
        200:
          description: centrifugo connection token 
          schema:
            type: object
            properties:
              token:
                type: string
  /account/subscribe/telegram:
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - account
      responses:
        200:
          description: telegram login token 
          schema:
            type: object
            properties:
              token:
                type: string
    delete:
      security:
        - ApiKeyHeader: []
      tags:
        - account
      responses:
        204:
          description: OK
  /notifications:
    get:
      security:
        - ApiKeyHeader: []
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/after'
        - $ref: '#/parameters/before'
        - in: query
          name: unread
          type: boolean
          default: false
      tags:
        - notifications
      responses:
        200:
          description: notification list
          schema:
            $ref: '#/definitions/NotificationList'
  /notifications/{id}:
    get:
      security:
        - ApiKeyHeader: []
      parameters:
        - $ref: '#/parameters/pathId'
      tags:
        - notifications
      responses:
        200:
          description: notification
          schema:
            $ref: '#/definitions/Notification'
        404:
          description: not found
          schema:
            $ref: '#/definitions/Error'
  /notifications/read:
    put:
      security:
        - ApiKeyHeader: []
      parameters:
        - in: query
          name: time
          type: number
          default: 0
      consumes:
        - application/x-www-form-urlencoded
      tags:
        - notifications
      responses:
        200:
          description: unread count
          schema:
            type: object
            properties:
              unread:
                type: integer
  /users:
    get:
      security:
        - ApiKeyHeader: []
      parameters:
        - in: query
          name: top
          type: string
          enum: [new, rank]
          default: new
        - in: query
          name: query
          type: string
          minLength: 1
          maxLength: 50
      tags:
        - users
      responses:
        200:
          description: OK
          schema:
            type: object
            properties:
              top:
                type: string
              query:
                type: string
              users:
                type: array
                items:
                  $ref: '#/definitions/Friend'
  /users/{name}:
    parameters:
      - $ref: '#/parameters/pathName'
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - users
      responses:
        200:
          description: User data
          schema:
            $ref: '#/definitions/Profile'
        404:
          description: User not found
          schema:
            $ref: '#/definitions/Error'
  /users/{name}/followers:
    parameters:
      - $ref: '#/parameters/pathName'
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/skip'
      security:
        - ApiKeyHeader: []
      tags:
        - users
      responses:
        200:
          description: User list
          schema:
            $ref: '#/definitions/FriendList'
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: User not found
          schema:
            $ref: '#/definitions/Error'
  /users/{name}/followings:
    parameters:
      - $ref: '#/parameters/pathName'
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/skip'
      security:
        - ApiKeyHeader: []
      tags:
        - users
      responses:
        200:
          description: User list
          schema:
            $ref: '#/definitions/FriendList'
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: User not found
          schema:
            $ref: '#/definitions/Error'
  /users/{name}/invited:
    parameters:
      - $ref: '#/parameters/pathName'
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/skip'
      security:
        - ApiKeyHeader: []
      tags:
        - users
      responses:
        200:
          description: User list
          schema:
            $ref: '#/definitions/FriendList'
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: User not found
          schema:
            $ref: '#/definitions/Error'
  /users/{name}/tlog:
    parameters:
      - $ref: '#/parameters/pathName'
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/after'
        - $ref: '#/parameters/before'
        - $ref: '#/parameters/tag'
        - $ref: '#/parameters/sort'
      security:
        - ApiKeyHeader: []
      tags:
        - users
      responses:
        200:
          description: Entry list
          schema:
            $ref: '#/definitions/Feed'
        404:
          description: User not found
          schema:
            $ref: '#/definitions/Error'
  /users/{name}/favorites:
    parameters:
      - $ref: '#/parameters/pathName'
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/after'
        - $ref: '#/parameters/before'
      security:
        - ApiKeyHeader: []
      tags:
        - users
      responses:
        200:
          description: Entry list
          schema:
            $ref: '#/definitions/Feed'
        404:
          description: User not found
          schema:
            $ref: '#/definitions/Error'
  /users/{name}/images:
    parameters:
      - $ref: '#/parameters/pathName'
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/after'
        - $ref: '#/parameters/before'
      security:
        - ApiKeyHeader: []
      tags:
        - users
      responses:
        200:
          description: Image list
          schema:
            $ref: '#/definitions/ImageList'
        404:
          description: User not found
          schema:
            $ref: '#/definitions/Error'
  /me:
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - me
      responses:
        200:
          description: your data
          schema:
            $ref: '#/definitions/AuthProfile'
    put:
      security:
        - ApiKeyHeader: []
      tags:
        - me
      consumes:
        - multipart/form-data
        - application/x-www-form-urlencoded
      parameters:
        - in: formData
          name: showName
          type: string
          minLength: 1
          maxLength: 20
          required: true
        - in: formData
          name: gender
          type: string
          enum: [male, female, not set]
          default: 'not set'
        - in: formData
          name: isDaylog
          type: boolean
          default: false
        - in: formData
          name: privacy
          type: string
          enum: [all, followers]
          required: true
        - in: formData
          name: title
          type: string
          maxLength: 500
          default: ''
        - in: formData
          name: birthday
          type: string
          format: full-date
          default: ''
        - in: formData
          name: country
          type: string
          maxLength: 50
          default: ''
        - in: formData
          name: city
          type: string
          maxLength: 50
          default: ''
        - in: formData
          name: showInTops
          type: boolean
          default: false
      responses:
        200:
          description: your data
          schema:
            $ref: '#/definitions/Profile'
  /me/avatar:
    put:
      security:
        - ApiKeyHeader: []
      tags:
        - me
      consumes:
        - multipart/form-data
      parameters:
        - in: formData
          name: file
          type: file
      responses:
        200:
          description: Avatar
          schema:
            $ref: '#/definitions/Avatar'
        400:
          description: bad request
          schema:
            $ref: '#/definitions/Error'
  /me/cover:
    put:
      security:
        - ApiKeyHeader: []
      tags:
        - me
      consumes:
        - multipart/form-data
      parameters:
        - in: formData
          name: file
          type: file
      responses:
        200:
          description: Cover
          schema:
            $ref: '#/definitions/Cover'
        400:
          description: bad request
          schema:
            $ref: '#/definitions/Error'
  /me/online:
    put:
      security:
        - ApiKeyHeader: []
      tags:
        - me
      responses:
        204:
          description: OK
  /me/followers:
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/skip'
      security:
        - ApiKeyHeader: []
      tags:
        - me
      responses:
        200:
          description: User list
          schema:
            $ref: '#/definitions/FriendList'
  /me/followings:
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/skip'
      security:
        - ApiKeyHeader: []
      tags:
        - me
      responses:
        200:
          description: User list
          schema:
            $ref: '#/definitions/FriendList'
  /me/invited:
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/skip'
      security:
        - ApiKeyHeader: []
      tags:
        - me
      responses:
        200:
          description: User list
          schema:
            $ref: '#/definitions/FriendList'
  /me/ignored:
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/skip'
      security:
        - ApiKeyHeader: []
      tags:
        - me
      responses:
        200:
          description: User list
          schema:
            $ref: '#/definitions/FriendList'
  /me/requested:
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/skip'
      security:
        - ApiKeyHeader: []
      tags:
        - me
      responses:
        200:
          description: User list
          schema:
            $ref: '#/definitions/FriendList'
  /me/tlog:
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/after'
        - $ref: '#/parameters/before'
        - $ref: '#/parameters/tag'
      security:
        - ApiKeyHeader: []
      tags:
        - me
      responses:
        200:
          description: Entry list
          schema:
            $ref: '#/definitions/Feed'
    post:
      security:
        - ApiKeyHeader: []
      tags:
        - me
      consumes:
        - multipart/form-data
        - application/x-www-form-urlencoded
      parameters:
        - in: formData
          name: title
          type: string
          maxLength: 500
          default: ''
        - in: formData
          name: content
          type: string
          required: true
          minLength: 1
          maxLength: 30000
        - in: formData
          name: privacy
          type: string
          enum: [all, followers, some, me]
          required: true
        - in: formData
          name: visibleFor
          type: array
          items:
            type: integer
            format: int64
            minimum: 1
        - in: formData
          name: isVotable
          type: boolean
          default: false
        - in: formData
          name: inLive
          type: boolean
          default: false
      responses:
        201:
          description: Entry data
          schema:
            $ref: '#/definitions/Entry'
        403:
          description: post in live restriction
          schema:
            $ref: '#/definitions/Error'
  /me/favorites:
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/after'
        - $ref: '#/parameters/before'
      security:
        - ApiKeyHeader: []
      tags:
        - me
      responses:
        200:
          description: Entry list
          schema:
            $ref: '#/definitions/Feed'
  /me/images:
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/after'
        - $ref: '#/parameters/before'
      security:
        - ApiKeyHeader: []
      tags:
        - me
      responses:
        200:
          description: Image list
          schema:
            $ref: '#/definitions/ImageList'
        404:
          description: User not found
          schema:
            $ref: '#/definitions/Error'
  /design:
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - design
      responses:
        200:
          description: Design of your tlog
          schema:
            $ref: '#/definitions/Design'
    put:
      consumes:
        - multipart/form-data
        - application/x-www-form-urlencoded
      parameters:
        - in: formData
          name: css
          type: string
          default: ''
          maxLength: 10000
        - in: formData
          name: backgroundColor
          type: string
          pattern: '#[0-9a-fA-F]{6}'
          default: '#ffffff'
        - in: formData
          name: textColor
          type: string
          pattern: '#[0-9a-fA-F]{6}'
          default: '#000000'
        - in: formData
          name: fontFamily
          type: string
        - in: formData
          name: fontSize
          type: integer
        - in: formData
          name: textAlignment
          type: string
          enum: [left, right, center, justify]
          required: true
      security:
        - ApiKeyHeader: []
      tags:
        - design
      responses:
        200:
          description: Design of your tlog
          schema:
            $ref: '#/definitions/Design'
  /design/fonts:
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - design
      responses:
        200:
          description: List of available font families
          schema:
            type: object
            properties:
              fonts:
                type: array
                items:
                  type: string
  /relations/to/{name}:
    parameters:
      - $ref: '#/parameters/pathName'
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - relations
      responses:
        200:
          description: your relationship with the user
          schema:
            $ref: '#/definitions/Relationship'
        404:
          description: User not found
          schema:
            $ref: '#/definitions/Error'
    put:
      parameters:
        - in: query
          name: r
          type: string
          enum: [followed, ignored]
          required: true
      security:
        - ApiKeyHeader: []
      tags:
        - relations
      responses:
        200:
          description: your relationship with the user
          schema:
            $ref: '#/definitions/Relationship'
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: User not found
          schema:
            $ref: '#/definitions/Error'
    delete:
      security:
        - ApiKeyHeader: []
      tags:
        - relations
      responses:
        200:
          description: your relationship with the user
          schema:
            $ref: '#/definitions/Relationship'
        404:
          description: User not found
          schema:
            $ref: '#/definitions/Error'
  /relations/from/{name}:
    parameters:
      - $ref: '#/parameters/pathName'
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - relations
      responses:
        200:
          description: the user relationship with you
          schema:
            $ref: '#/definitions/Relationship'
        404:
          description: User not found
          schema:
            $ref: '#/definitions/Error'
    put:
      summary: permit the user to follow you
      security:
        - ApiKeyHeader: []
      tags:
        - relations
      responses:
        200:
          description: the user relationship with you
          schema:
            $ref: '#/definitions/Relationship'
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: User not found
          schema:
            $ref: '#/definitions/Error'
    delete:
      summary: cancel following request or unsubscribe the user
      security:
        - ApiKeyHeader: []
      tags:
        - relations
      responses:
        200:
          description: the user relationship with you
          schema:
            $ref: '#/definitions/Relationship'
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: User not found
          schema:
            $ref: '#/definitions/Error'
  /entries/live:
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/after'
        - $ref: '#/parameters/before'
        - $ref: '#/parameters/tag'
        - in: query
          name: section
          type: string
          enum: [entries, comments]
          default: entries
      security:
        - ApiKeyHeader: []
      tags:
        - entries
      responses:
        200:
          description: Entry list
          schema:
            $ref: '#/definitions/Feed'
  /entries/friends:
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/after'
        - $ref: '#/parameters/before'
        - $ref: '#/parameters/tag'
      security:
        - ApiKeyHeader: []
      tags:
        - entries
      responses:
        200:
          description: Entry list
          schema:
            $ref: '#/definitions/Feed'
  /entries/watching:
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/after'
        - $ref: '#/parameters/before'
      security:
        - ApiKeyHeader: []
      tags:
        - entries
      responses:
        200:
          description: Entry list
          schema:
            $ref: '#/definitions/Feed'
  /entries/best:
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/tag'
        - in: query
          name: category
          type: string
          enum: [month, week]
          default: month
      security:
        - ApiKeyHeader: []
      tags:
        - entries
      responses:
        200:
          description: Entry list
          schema:
            $ref: '#/definitions/Feed'
  /entries/anonymous:
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/after'
        - $ref: '#/parameters/before'
        - $ref: '#/parameters/tag'
      security:
        - ApiKeyHeader: []
      tags:
        - entries
      responses:
        200:
          description: Entry list
          schema:
            $ref: '#/definitions/Feed'
    post:
      security:
        - ApiKeyHeader: []
      tags:
        - entries
      consumes:
        - multipart/form-data
        - application/x-www-form-urlencoded
      parameters:
        - in: formData
          name: title
          type: string
          default: ''
          maxLength: 500
        - in: formData
          name: content
          type: string
          minLength: 1
          maxLength: 30000
          required: true
        - in: formData
          name: anonymous_comments
          type: boolean
          default: false
      responses:
        201:
          description: Entry data
          schema:
            $ref: '#/definitions/Entry'
  /entries/{id}:
    parameters:
      - $ref: '#/parameters/pathId'
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - entries
      responses:
        200:
          description: Entry data
          schema:
            $ref: '#/definitions/Entry'
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Entry not found
          schema:
            $ref: '#/definitions/Error'
    put:
      security:
        - ApiKeyHeader: []
      tags:
        - entries
      consumes:
        - multipart/form-data
        - application/x-www-form-urlencoded
      parameters:
        - in: formData
          name: title
          type: string
          default: ''
          maxLength: 500
        - in: formData
          name: content
          type: string
          required: true
          minLength: 1
          maxLength: 30000
        - in: formData
          name: privacy
          type: string
          enum: [all, followers, some, me, anonymous]
          required: true
        - in: formData
          name: visibleFor
          type: array
          items:
            type: integer
            format: int64
            minimum: 1
        - in: formData
          name: isVotable
          type: boolean
          default: false
        - in: formData
          name: inLive
          type: boolean
          default: false
        - in: formData
          name: anonymous_comments
          type: boolean
          default: false
      responses:
        200:
          description: Entry data
          schema:
            $ref: '#/definitions/Entry'
        403:
          description: access denied or post in live restriction
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Entry not found
          schema:
            $ref: '#/definitions/Error'
    delete:
      security:
        - ApiKeyHeader: []
      tags:
        - entries
      responses:
        200:
          description: OK
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Entry not found
          schema:
            $ref: '#/definitions/Error'
  /entries/{id}/vote:
    parameters:
      - $ref: '#/parameters/pathId'
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - votes
      responses:
        200:
          description: vote status
          schema:
            $ref: '#/definitions/Rating'
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Entry not found
          schema:
            $ref: '#/definitions/Error'
    put:
      parameters:
        - in: query
          name: positive
          type: boolean
          default: true
      security:
        - ApiKeyHeader: []
      tags:
        - votes
      responses:
        200:
          description: vote status
          schema:
            $ref: '#/definitions/Rating'
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Entry not found
          schema:
            $ref: '#/definitions/Error'
    delete:
      security:
        - ApiKeyHeader: []
      tags:
        - votes
      responses:
        200:
          description: vote status
          schema:
            $ref: '#/definitions/Rating'
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Entry not found
          schema:
            $ref: '#/definitions/Error'
  /entries/{id}/favorite:
    parameters:
      - $ref: '#/parameters/pathId'
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - favorites
      responses:
        200:
          description: favorite status
          schema:
            $ref: '#/definitions/FavoriteStatus'
        404:
          description: Entry not found
          schema:
            $ref: '#/definitions/Error'
    put:
      security:
        - ApiKeyHeader: []
      tags:
        - favorites
      responses:
        200:
          description: favorite status
          schema:
            $ref: '#/definitions/FavoriteStatus'
        404:
          description: Entry not found
          schema:
            $ref: '#/definitions/Error'
    delete:
      security:
        - ApiKeyHeader: []
      tags:
        - favorites
      responses:
        200:
          description: favorite status
          schema:
            $ref: '#/definitions/FavoriteStatus'
        404:
          description: Entry not found
          schema:
            $ref: '#/definitions/Error'
  /entries/{id}/watching:
    parameters:
      - $ref: '#/parameters/pathId'
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - watchings
      responses:
        200:
          description: watching status
          schema:
            $ref: '#/definitions/WatchingStatus'
        404:
          description: Entry not found
          schema:
            $ref: '#/definitions/Error'
    put:
      security:
        - ApiKeyHeader: []
      tags:
        - watchings
      responses:
        200:
          description: watching status
          schema:
            $ref: '#/definitions/WatchingStatus'
        404:
          description: Entry not found
          schema:
            $ref: '#/definitions/Error'
    delete:
      security:
        - ApiKeyHeader: []
      tags:
        - watchings
      responses:
        200:
          description: watching status
          schema:
            $ref: '#/definitions/WatchingStatus'
        404:
          description: Entry not found
          schema:
            $ref: '#/definitions/Error'
  /entries/{id}/comments:
    parameters:
      - $ref: '#/parameters/pathId'
    get:
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/after'
        - $ref: '#/parameters/before'
      security:
        - ApiKeyHeader: []
      tags:
        - comments
      responses:
        200:
          description: comments list
          schema:
            $ref: '#/definitions/CommentList'
        404:
          description: Entry not found
          schema:
            $ref: '#/definitions/Error'
    post:
      consumes:
        - multipart/form-data
        - application/x-www-form-urlencoded
      parameters:
        - in: formData
          name: content
          type: string
          minLength: 1
          maxLength: 1000
          required: true
      security:
        - ApiKeyHeader: []
      tags:
        - comments
      responses:
        201:
          description: Comment data
          schema:
            $ref: '#/definitions/Comment'
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Entry not found
          schema:
            $ref: '#/definitions/Error'
  /comments/{id}:
    parameters:
      - $ref: '#/parameters/pathId'
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - comments
      responses:
        200:
          description: Comment data
          schema:
            $ref: '#/definitions/Comment'
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Comment not found
          schema:
            $ref: '#/definitions/Error'
    put:
      consumes:
        - multipart/form-data
        - application/x-www-form-urlencoded
      parameters:
        - in: formData
          name: content
          type: string
          minLength: 1
          maxLength: 1000
          required: true
      security:
        - ApiKeyHeader: []
      tags:
        - comments
      responses:
        200:
          description: Comment data
          schema:
            $ref: '#/definitions/Comment'
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Comment not found
          schema:
            $ref: '#/definitions/Error'
    delete:
      security:
        - ApiKeyHeader: []
      tags:
        - comments
      responses:
        200:
          description: OK
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Comment not found
          schema:
            $ref: '#/definitions/Error'
  /comments/{id}/vote:
    parameters:
      - $ref: '#/parameters/pathId'
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - votes
      responses:
        200:
          description: vote status
          schema:
            $ref: '#/definitions/Rating'
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Comment not found
          schema:
            $ref: '#/definitions/Error'
    put:
      parameters:
        - in: query
          name: positive
          type: boolean
          default: true
      security:
        - ApiKeyHeader: []
      tags:
        - votes
      responses:
        200:
          description: vote status
          schema:
            $ref: '#/definitions/Rating'
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Comment not found
          schema:
            $ref: '#/definitions/Error'
    delete:
      security:
        - ApiKeyHeader: []
      tags:
        - votes
      responses:
        200:
          description: vote status
          schema:
            $ref: '#/definitions/Rating'
        403:
          description: access denied
          schema:
            $ref: '#/definitions/Error'
        404:
          description: Comment not found
          schema:
            $ref: '#/definitions/Error'
  /adm/grandson:
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - adm
      responses:
        200:
          description: your address
          schema:
            type: object
            properties:
              postcode:
                type: string
              country:
                type: string
              address:
                type: string
              name:
                type: string
              comment:
                type: string
              anonymous:
                type: boolean
        410:
          description: registration finished
          schema:
            $ref: '#/definitions/Error'
    post:
      security:
        - ApiKeyHeader: []
      tags:
        - adm
      consumes:
        - multipart/form-data
      parameters:
        - in: formData
          name: postcode
          type: string
          maxLength: 50
          required: true
        - in: formData
          name: country
          type: string
          maxLength: 50
          required: true
        - in: formData
          name: address
          type: string
          maxLength: 500
          required: true
        - in: formData
          name: name
          type: string
          maxLength: 100
          required: true
        - in: formData
          name: comment
          type: string
          default: ''
          maxLength: 1000
        - in: formData
          name: anonymous
          type: boolean
          default: false
      responses:
        200:
          description: OK
        410:
          description: registration finished
          schema:
            $ref: '#/definitions/Error'
  /adm/grandson/status:
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - adm
      responses:
        200:
          description: status of your gifts
          schema:
            type: object
            properties:
              sent:
                type: boolean
              received:
                type: boolean
        403:
          description: you're not registered in adm
          schema:
            $ref: '#/definitions/Error'
        410:
          description: adm finished
          schema:
            $ref: '#/definitions/Error'
    post:
      security:
        - ApiKeyHeader: []
      tags:
        - adm
      consumes:
        - application/x-www-form-urlencoded
      parameters:
        - in: query
          name: received
          type: boolean
          required: true
      responses:
        200:
          description: OK
        403:
          description: you're not registered in adm
          schema:
            $ref: '#/definitions/Error'
        410:
          description: adm finished
          schema:
            $ref: '#/definitions/Error'
  /adm/grandfather:
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - adm
      responses:
        200:
          description: your grandson address
          schema:
            type: object
            properties:
              postcode:
                type: string
              country:
                type: string
              address:
                type: string
              fullname:
                type: string
              comment:
                type: string
              name:
                type: string
        403:
          description: you're not registered in adm
          schema:
            $ref: '#/definitions/Error'
        410:
          description: adm finished
          schema:
            $ref: '#/definitions/Error'
  /adm/grandfather/status:
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - adm
      responses:
        200:
          description: status of your gifts
          schema:
            type: object
            properties:
              sent:
                type: boolean
              received:
                type: boolean
        403:
          description: you're not registered in adm
          schema:
            $ref: '#/definitions/Error'
        410:
          description: adm finished
          schema:
            $ref: '#/definitions/Error'
    post:
      security:
        - ApiKeyHeader: []
      tags:
        - adm
      consumes:
        - application/x-www-form-urlencoded
      parameters:
        - in: query
          name: sent
          type: boolean
          required: true
      responses:
        200:
          description: OK
        403:
          description: you're not registered in adm
          schema:
            $ref: '#/definitions/Error'
        410:
          description: adm finished
          schema:
            $ref: '#/definitions/Error'
  /adm/stat:
    get:
      security:
        - ApiKeyHeader: []
      tags:
        - adm
      responses:
        200:
          description: ADM stats
          schema:
            type: object
            properties:
              grandsons:
                type: integer
              sent:
                type: integer
              received:
                type: integer
        410:
          description: adm finished
          schema:
            $ref: '#/definitions/Error'
  /images:
    post:
      security:
        - ApiKeyHeader: []
      tags:
        - images
      consumes:
        - multipart/form-data
      parameters:
        - in: formData
          name: file
          type: file
      responses:
        200:
          description: Image
          schema:
            $ref: '#/definitions/Image'
        400:
          description: bad request
          schema:
            $ref: '#/definitions/Error'
produces:
  - application/json
swagger: '2.0'
basePath: /api/v1
